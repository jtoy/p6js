hello world<br>
<title>p6 - scratchpad</title>
<style>
#container{
  display:flex;
  flex-direction:row;
  justify-content: space-around;
}
#editor{
  display:flex;
  float:left;
  flex-direction:column;
}
#side{
  display:flex;
  flex-direction:column;
}
body {background-color: powderblue;}
</style>
  <div id="play">play</div>
  <script>if (typeof module === 'object') {window.module = module; module = undefined;}</script>
  <script src="jquery-3.1.1.min.js"></script> 
  <script src="underscore-min.js"></script> 
<div>
  <div id="editor">
    <pre>
<code>
<textarea id="box" rows=50 cols=100>
  function setup(){
  }

  function draw(){
  }
</textarea>
</code>
    </pre>
</div>
<div id="side">
 side
 <div id="line">CURRENT LINE</div>
</div>
</div>


<script>
if (window.module) module = window.module;
const ipc = require('electron').ipcRenderer
var code = $("#box").val()


$("#box").on('keyup',function() {
  if(code != $("#box").val()){
    var new_code = $("#box").val()
    ipc.send('async_save_scratch_or_global_file', new_code);
    code = new_code
    var caretPos = $('#box').prop("selectionStart");
    console.log(caretPos)
    var start, end ;
    var myString = $("#box").val()
    for (start = caretPos; start >= 0 && myString[start] != "\n"; --start);
    for (end = caretPos; end < myString.length && myString[end] != "\n"; ++end);
    var line = myString.substring(start + 1, end - 1);
    $("#line").text(line)
  }
});

var fs = require('fs');
$("#play").on('click',function(){
  ipc.send('asynchronous_load_scratch', 'ping')
});

ipc.on('getSaveAs', (event, fileData) => {
  //var editor = ace.edit("editor");
  //var fileData = editor.getValue();
  ipc.send('fileSaveAs', $("#box").val());
});



</script>
